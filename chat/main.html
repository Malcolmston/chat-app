<script src="https://kit.fontawesome.com/fd76b8450f.js" crossorigin="anonymous"></script>
	    <script src="/socket.io/socket.io.js"></script>



<div class='bar'>
	<form id='home' action='/home' method="get">
	    <i class="fa-solid fa-house" onclick=''></i>
		<a>Log out</a>  

		
	</form>
  <table>
  <tr>
    <th>first name</th>
    <th>last name</th>
    <th>user name</th>
	  <th>send</th>
  </tr>
 

</table>
</div>

<script>
	const home = document.getElementById('home')

	home.addEventListener('click',function(params) {
		home.submit()
	})
</script>

<div class="chats">
   	<ul id="messages"></ul>
	<form id='form' action='/signup' method="">
<input id="input" autocomplete="off" /><button>Send</button>			
	</form>



<script>
      var socket = io();

      var messages = document.getElementById('messages');
      var form = document.getElementById('form');
      var input = document.getElementById('input');

      form.addEventListener('submit', function(e) {
        e.preventDefault();
        if (input.value) {
          socket.emit('chat message', input.value);
          input.value = '';
        }
      });
//<a href="#" data-bs-toggle="tooltip" data-bs-placement="left" title="Hooray!">Hover</a>

      socket.on('chat message', function(msg) {
        var item = document.createElement('li');
		
        item.textContent = msg;
        messages.appendChild(item);
        window.scrollTo(0, document.body.scrollHeight);
      });
    </script>

</div>	



<style>
	.fa-house {
		    width: 30px;
    height: 30px;
	}
	/*
this hadeles the css for UI in chat
*/
html,
body {
  height: 100%;
  margin: 0;
}
.bar {
  width: 300px;
  height: 100%;
  background: #d3d3d3;
  display: static;
  
  overflow-y: auto;
}
.bar > table {
  width: 100%;
}
table,
th,
td {
  border: 1px solid #fff;
  border-collapse: collapse;
}
th,
td {
  background-color: #96d4d4;
}
td > button {
  width: 100%;
  height: 100%;
  background-color: #73c6aa;
  display: static;
  border: none;
}


.chats {
position: absolute;

left: 400px;
}





/*
this handles the styling for the chat window
*/






      #form { 
          margin-bottom: -0rem;
		  background: rgba(0, 0, 0, 0.15); 
		  padding: 0.25rem; 
		  position: fixed; 
		  bottom: 0; 
		  left: 300; 
		  right: 0; 
		  display: flex; 
		  height: 3rem; 
		  box-sizing: border-box; 
		  backdrop-filter: blur(10px); 
	  }
      #input { 
		  border: none; 
		  padding: 0 1rem; 
		  flex-grow: 1; 
		  border-radius: 2rem; 
		  margin: 0.25rem; 
	  }
      #input:focus { 
		  outline: none; 
	  }
      #form > button { 
		  background: #333; 
		  border: none; 
		  padding: 0 1rem; 
		  margin: 0.25rem; 
		  border-radius: 3px; 
		  outline: none; 
		  color: #fff; 
	  }

      #messages { 
		  list-style-type: none; 
				 margin: 0; 
				 padding: 0; 
	  }
      #messages > li { 
		  padding: 0.5rem 1rem; 
	  }
      #messages > li:nth-child(odd) { 
		  background: #efefef; 
	  }
</style>


<script type = "text/javascript">
	      var socket = io();

function addPeple(fname, lname,username) {
  let table = document.querySelector("table");

  let tr = document.createElement("tr");

  let arr = [fname, lname, username, "open"];

  let button = document.createElement("button");
  button.innerHTML = "open";

  arr.map(function (x) {
    if (x == "open") {
      let td = document.createElement("td");
button.addEventListener("click", function () {

	socket.emit('sendingPERSON', fname+' '+lname+' '+username);
	
	
//alert( fname+' '+lname+' '+username )
	//input.placeholder = `${you}`
  });
      td.append(button);

      tr.append(td);
    } else {
      let td = document.createElement("td");
      let txt = document.createTextNode(x);

      td.append(txt);

      tr.append(td);
    }
  });

  table.append(tr);
}

//addPeple("malcolm", "stone", "user");
//addPeple("bill", "stone");



const buttons = document.querySelectorAll("button");
//let you = "malcolm stone user";


	socket.on('whoAreyou', function(msg) {
			//  msg.forEach(function(p) {
			  	addPeple(...msg.split(' '))
			//  })

				input.placeholder = `send from ${msg}`

		
			  socket.off('whoAreyou');
		  })

	
	      socket.on('dataTransvor', function(msg) {
			  
			  msg.forEach(function(p) {
			  	addPeple(p.first_name,p.last_name,p.username)
			  })
			  
			  socket.off('dataTransvor');
		  })


	//whoAreyou
	</script>

